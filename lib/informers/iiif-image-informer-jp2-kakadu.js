// Generated by CoffeeScript 1.10.0
(function() {
  var IIIFImageInformerJP2Kakadu, child_process, parsexml;

  parsexml = require('xml2js').parseString;

  child_process = require('child_process');

  IIIFImageInformerJP2Kakadu = (function() {
    function IIIFImageInformerJP2Kakadu(path) {
      this.path = path;
    }

    IIIFImageInformerJP2Kakadu.prototype.inform = function(cb) {
      var kdu_info_cmd;
      kdu_info_cmd = "kdu_jp2info -siz -boxes 1 -com -i " + this.path;
      return child_process.exec(kdu_info_cmd, (function(_this) {
        return function(err, stdout, stderr) {
          return parsexml(stdout, function(err, kinfo) {
            var info;
            info = _this.extract_kinfo(kinfo);
            return cb(info);
          });
        };
      })(this));
    };

    IIIFImageInformerJP2Kakadu.prototype.extract_kinfo = function(kinfo) {
      var codestream, jpc;
      jpc = kinfo.JP2_family_file.jp2c[0];
      codestream = jpc.codestream[0];
      return {
        width: parseInt(codestream.width[0]),
        height: parseInt(codestream.height[0])
      };
    };

    return IIIFImageInformerJP2Kakadu;

  })();

  exports.IIIFImageInformerJP2Kakadu = IIIFImageInformerJP2Kakadu;

}).call(this);
