// Generated by CoffeeScript 1.10.0
(function() {
  var ExtractorJp2, ExtractorJp2Openjpeg, SharpManipulator, child_process, tempfile,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  tempfile = require('tempfile');

  child_process = require('child_process');

  SharpManipulator = require('../manipulators/sharp-manipulator').SharpManipulator;

  ExtractorJp2 = require('./extractor-jp2').ExtractorJp2;

  ExtractorJp2Openjpeg = (function(superClass) {
    extend(ExtractorJp2Openjpeg, superClass);

    function ExtractorJp2Openjpeg() {
      return ExtractorJp2Openjpeg.__super__.constructor.apply(this, arguments);
    }

    ExtractorJp2Openjpeg.prototype.set_temp_out_image = function() {
      return this.temp_out_image = tempfile('.bmp');
    };

    ExtractorJp2Openjpeg.prototype.extract_cmd = function() {
      var cmd, reduction, region;
      cmd = "opj_decompress -i " + this.path + " -o " + this.temp_out_image + " ";
      if (this.params.region !== 'full') {
        region = this.params.region;
        cmd += "-d            \"" + region.x + "," + region.y + "," + (region.x + region.w) + "," + (region.y + region.h) + "\"";
      }
      reduction = this.params.size === 'full' ? 0 : this.pick_reduction();
      return cmd + (" -r " + reduction);
    };

    return ExtractorJp2Openjpeg;

  })(ExtractorJp2);

  exports.ExtractorJp2Openjpeg = ExtractorJp2Openjpeg;

}).call(this);
